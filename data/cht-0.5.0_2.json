{
    "level": "Info",
    "analyzer": "UnsafeDataflow",
    "op_type": "Transmute",
    "description": "Potential unsafe dataflow issue in `map::bucket_array_ref::BucketArrayRef::<'a, K, V, S>::get_key_value_and`",
    "file": "cht-0.5.0/src/map/bucket_array_ref.rs",
    "start_line": 33,
    "start_col": 5,
    "end_line": 75,
    "end_col": 6,
    "code_snippet": "pub(crate) fn get_key_value_and<Q: Hash + Eq + ?Sized, F: FnOnce(&K, &V) -> T, T>(\n        &self,\n        key: &Q,\n        hash: u64,\n        with_entry: F,\n    ) -> Option<T>\n    where\n        K: Borrow<Q>,\n    {\n        let guard = &crossbeam_epoch::pin();\n        let current_ref = self.get(guard);\n        let mut bucket_array_ref = current_ref;\n\n        let result;\n\n        loop {\n            match bucket_array_ref\n                .get(guard, hash, key)\n                .map(|p| unsafe { p.as_ref() })\n            {\n                Ok(Some(Bucket {\n                    key,\n                    maybe_value: value,\n                })) => {\n                    result = Some(with_entry(key, unsafe { &*value.as_ptr() }));\n\n                    break;\n                }\n                Ok(None) => {\n                    result = None;\n\n                    break;\n                }\n                Err(_) => {\n                    bucket_array_ref = bucket_array_ref.rehash(guard, self.build_hasher);\n                }\n            }\n        }\n\n        self.swing(guard, current_ref, bucket_array_ref);\n\n        result\n    }"
}