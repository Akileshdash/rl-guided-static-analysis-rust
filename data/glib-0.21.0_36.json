{
    "level": "Info",
    "analyzer": "UnsafeDataflow",
    "op_type": "Transmute",
    "description": "Potential unsafe dataflow issue in `variant::Variant::from_data_with_type`",
    "file": "glib-0.21.0/src/variant.rs",
    "start_line": 685,
    "start_col": 5,
    "end_line": 706,
    "end_col": 6,
    "code_snippet": "pub fn from_data_with_type<A: AsRef<[u8]>>(data: A, type_: &VariantTy) -> Self {\n        unsafe {\n            let data = Box::new(data);\n            let (data_ptr, len) = {\n                let data = (*data).as_ref();\n                (data.as_ptr(), data.len())\n            };\n\n            unsafe extern \"C\" fn free_data<A: AsRef<[u8]>>(ptr: ffi::gpointer) {\n                let _ = Box::from_raw(ptr as *mut A);\n            }\n\n            from_glib_none(ffi::g_variant_new_from_data(\n                type_.as_ptr() as *const _,\n                data_ptr as ffi::gconstpointer,\n                len,\n                false.into_glib(),\n                Some(free_data::<A>),\n                Box::into_raw(data) as ffi::gpointer,\n            ))\n        }\n    }"
}