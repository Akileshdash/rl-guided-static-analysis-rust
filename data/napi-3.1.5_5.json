{
    "level": "Warning",
    "analyzer": "UnsafeDestructor",
    "op_type": null,
    "description": "unsafe block detected in drop",
    "file": "napi-3.1.5/src/bindgen_runtime/js_values/arraybuffer.rs",
    "start_line": 448,
    "start_col": 5,
    "end_line": 448,
    "end_col": 24,
    "code_snippet": "impl Drop for $name {\n      fn drop(&mut self) {\n        if let Some((ref_, env)) = self.raw {\n          // If the ref is null, it means the TypedArray has been called `ToNapiValue::to_napi_value`, and the `ref` has been deleted\n          // If the env is null, it means the TypedArray is copied in `&mut TypedArray ToNapiValue::to_napi_value`, and the `ref` will be deleted in the raw TypedArray\n          if ref_.is_null() || env.is_null() {\n            return;\n          }\n          #[cfg(all(feature = \"napi4\", not(feature = \"noop\")))]\n          {\n            if CUSTOM_GC_TSFN_DESTROYED.load(Ordering::SeqCst) {\n              return;\n            }\n            if !THREADS_CAN_ACCESS_ENV.with(|cell| cell.get()) {\n              let status = unsafe {\n                sys::napi_call_threadsafe_function(\n                  CUSTOM_GC_TSFN.load(std::sync::atomic::Ordering::SeqCst),\n                  ref_.cast(),\n                  1,\n                )\n              };\n              assert!(\n                status == sys::Status::napi_ok || status == sys::Status::napi_closing,\n                \"Call custom GC in ArrayBuffer::drop failed {}\",\n                Status::from(status)\n              );\n              return;\n            }\n          }\n          let mut ref_count = 0;\n          crate::check_status_or_throw!(\n            env,\n            unsafe { sys::napi_reference_unref(env, ref_, &mut ref_count) },\n            \"Failed to unref ArrayBuffer reference in drop\"\n          );\n          debug_assert!(\n            ref_count == 0,\n            \"ArrayBuffer reference count in ArrayBuffer::drop is not zero\"\n          );\n          crate::check_status_or_throw!(\n            env,\n            unsafe { sys::napi_delete_reference(env, ref_) },\n            \"Failed to delete ArrayBuffer reference in drop\"\n          );\n          return;\n        }\n        // If the `finalizer_notify` is not null, it means the data is external, and we call the finalizer instead of the `Vec::from_raw_parts`\n        if !self.finalizer_notify().is_null() {\n          let finalizer = unsafe { Box::from_raw(self.finalizer_notify) };\n          (finalizer)(self.data, self.length);\n          return;\n        }\n        if !self.data.is_null() {\n          let length = self.length;\n          unsafe { Vec::from_raw_parts(self.data, length, length) };\n        }\n      }\n    }"
}