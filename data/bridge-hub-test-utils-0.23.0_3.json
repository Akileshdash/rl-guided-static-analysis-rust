{
    "level": "Info",
    "analyzer": "UnsafeDataflow",
    "op_type": "Transmute",
    "description": "Potential unsafe dataflow issue in `test_cases::can_calculate_weight_for_paid_export_message_with_reserve_transfer`",
    "file": "bridge-hub-test-utils-0.23.0/src/test_cases/mod.rs",
    "start_line": 575,
    "start_col": 1,
    "end_line": 660,
    "end_col": 2,
    "code_snippet": "pub fn can_calculate_weight_for_paid_export_message_with_reserve_transfer<\n\tRuntime,\n\tXcmConfig,\n\tWeightToFee,\n>() -> u128\nwhere\n\tRuntime: frame_system::Config + pallet_balances::Config,\n\tXcmConfig: xcm_executor::Config,\n\tWeightToFee: frame_support::weights::WeightToFee<Balance = BalanceOf<Runtime>>,\n\t<WeightToFee as frame_support::weights::WeightToFee>::Balance: From<u128> + Into<u128>,\n{\n\t// data here are not relevant for weighing\n\tlet mut xcm = Xcm(vec![\n\t\tWithdrawAsset(Assets::from(vec![Asset {\n\t\t\tid: AssetId(Location::new(1, [])),\n\t\t\tfun: Fungible(34333299),\n\t\t}])),\n\t\tBuyExecution {\n\t\t\tfees: Asset { id: AssetId(Location::new(1, [])), fun: Fungible(34333299) },\n\t\t\tweight_limit: Unlimited,\n\t\t},\n\t\tSetAppendix(Xcm(vec![DepositAsset {\n\t\t\tassets: Wild(AllCounted(1)),\n\t\t\tbeneficiary: Location::new(1, [Parachain(1000)]),\n\t\t}])),\n\t\tExportMessage {\n\t\t\tnetwork: Polkadot,\n\t\t\tdestination: [Parachain(1000)].into(),\n\t\t\txcm: Xcm(vec![\n\t\t\t\tReserveAssetDeposited(Assets::from(vec![Asset {\n\t\t\t\t\tid: AssetId(Location::new(2, [GlobalConsensus(Kusama)])),\n\t\t\t\t\tfun: Fungible(1000000000000),\n\t\t\t\t}])),\n\t\t\t\tClearOrigin,\n\t\t\t\tBuyExecution {\n\t\t\t\t\tfees: Asset {\n\t\t\t\t\t\tid: AssetId(Location::new(2, [GlobalConsensus(Kusama)])),\n\t\t\t\t\t\tfun: Fungible(1000000000000),\n\t\t\t\t\t},\n\t\t\t\t\tweight_limit: Unlimited,\n\t\t\t\t},\n\t\t\t\tDepositAsset {\n\t\t\t\t\tassets: Wild(AllCounted(1)),\n\t\t\t\t\tbeneficiary: Location::new(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t[xcm::latest::prelude::AccountId32 {\n\t\t\t\t\t\t\tnetwork: None,\n\t\t\t\t\t\t\tid: [\n\t\t\t\t\t\t\t\t212, 53, 147, 199, 21, 253, 211, 28, 97, 20, 26, 189, 4, 169, 159,\n\t\t\t\t\t\t\t\t214, 130, 44, 133, 88, 133, 76, 205, 227, 154, 86, 132, 231, 165,\n\t\t\t\t\t\t\t\t109, 162, 125,\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}],\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t\tSetTopic([\n\t\t\t\t\t116, 82, 194, 132, 171, 114, 217, 165, 23, 37, 161, 177, 165, 179, 247, 114,\n\t\t\t\t\t137, 101, 147, 70, 28, 157, 168, 32, 154, 63, 74, 228, 152, 180, 5, 63,\n\t\t\t\t]),\n\t\t\t]),\n\t\t},\n\t\tSetTopic([\n\t\t\t36, 224, 250, 165, 82, 195, 67, 110, 160, 170, 140, 87, 217, 62, 201, 164, 42, 98, 219,\n\t\t\t157, 124, 105, 248, 25, 131, 218, 199, 36, 109, 173, 100, 122,\n\t\t]),\n\t]);\n\n\t// get weight\n\tlet weight = XcmConfig::Weigher::weight(&mut xcm, Weight::MAX);\n\tassert_ok!(weight);\n\tlet weight = weight.unwrap();\n\t// check if sane\n\tlet max_expected = Runtime::BlockWeights::get().max_block / 10;\n\tassert!(\n\t\tweight.all_lte(max_expected),\n\t\t\"calculated weight: {:?}, max_expected: {:?}\",\n\t\tweight,\n\t\tmax_expected\n\t);\n\n\t// check fee, should not be 0\n\tlet estimated_fee = WeightToFee::weight_to_fee(&weight);\n\tassert!(estimated_fee > BalanceOf::<Runtime>::zero());\n\n\testimated_fee.into()\n}"
}