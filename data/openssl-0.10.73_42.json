{
    "level": "Info",
    "analyzer": "UnsafeDataflow",
    "op_type": "Transmute",
    "description": "Potential unsafe dataflow issue in `ssl::callbacks::raw_cookie_generate`",
    "file": "openssl-0.10.73/src/ssl/callbacks.rs",
    "start_line": 496,
    "start_col": 1,
    "end_line": 526,
    "end_col": 2,
    "code_snippet": "pub extern \"C\" fn raw_cookie_generate<F>(\n    ssl: *mut ffi::SSL,\n    cookie: *mut c_uchar,\n    cookie_len: *mut c_uint,\n) -> c_int\nwhere\n    F: Fn(&mut SslRef, &mut [u8]) -> Result<usize, ErrorStack> + 'static + Sync + Send,\n{\n    unsafe {\n        let ssl = SslRef::from_ptr_mut(ssl);\n        let callback = ssl\n            .ssl_context()\n            .ex_data(SslContext::cached_ex_index::<F>())\n            .expect(\"BUG: cookie generate callback missing\") as *const F;\n        // We subtract 1 from DTLS1_COOKIE_LENGTH as the ostensible value, 256, is erroneous but retained for\n        // compatibility. See comments in dtls1.h.\n        #[allow(clippy::unnecessary_cast)]\n        let slice =\n            util::from_raw_parts_mut(cookie as *mut u8, ffi::DTLS1_COOKIE_LENGTH as usize - 1);\n        match (*callback)(ssl, slice) {\n            Ok(len) => {\n                *cookie_len = len as c_uint;\n                1\n            }\n            Err(e) => {\n                e.put();\n                0\n            }\n        }\n    }\n}"
}