{
    "level": "Info",
    "analyzer": "UnsafeDataflow",
    "op_type": "Transmute",
    "description": "Potential unsafe dataflow issue in `analysis::subprogram::<impl analysis::analyze::AnalyzeContext<'a, '_>>::subprogram_specification`",
    "file": "vhdl_lang-0.85.0/src/analysis/subprogram.rs",
    "start_line": 98,
    "start_col": 5,
    "end_line": 210,
    "end_col": 6,
    "code_snippet": "pub(crate) fn subprogram_specification(\n        &self,\n        scope: &Scope<'a>,\n        parent: EntRef<'a>,\n        subprogram: &mut SubprogramSpecification,\n        span: TokenSpan,\n        to_kind: impl Fn(Signature<'a>) -> Overloaded<'a>,\n        diagnostics: &mut dyn DiagnosticHandler,\n    ) -> EvalResult<(Scope<'a>, EntRef<'a>)> {\n        let subpgm_region = scope.nested();\n        let ent = self.arena.explicit(\n            subprogram\n                .subpgm_designator()\n                .item\n                .clone()\n                .into_designator(),\n            parent,\n            AnyEntKind::Overloaded(to_kind(Signature::new(ParameterRegion::default(), None))),\n            Some(subprogram.subpgm_designator().pos(self.ctx)),\n            span,\n            Some(self.source()),\n        );\n\n        let (signature, generic_map) = match subprogram {\n            SubprogramSpecification::Function(fun) => {\n                let generic_map = if let Some(header) = &mut fun.header {\n                    Some(self.subprogram_header(&subpgm_region, ent, header, diagnostics)?)\n                } else {\n                    None\n                };\n                let params = if let Some(parameter_list) = &mut fun.parameter_list {\n                    self.analyze_interface_list(&subpgm_region, ent, parameter_list, diagnostics)\n                } else {\n                    Ok(FormalRegion::new_params())\n                };\n                let return_type = self.type_name(\n                    &subpgm_region,\n                    fun.return_type.span,\n                    &mut fun.return_type.item,\n                    diagnostics,\n                );\n                match ParameterRegion::from_formal_region(params?) {\n                    Ok(params) => (Signature::new(params, Some(return_type?)), generic_map),\n                    Err(invalid_formals) => {\n                        self.push_invalid_formals_into_diagnostics(&invalid_formals, diagnostics);\n                        return Err(EvalError::Unknown);\n                    }\n                }\n            }\n            SubprogramSpecification::Procedure(procedure) => {\n                let generic_map = if let Some(header) = &mut procedure.header {\n                    Some(self.subprogram_header(&subpgm_region, ent, header, diagnostics)?)\n                } else {\n                    None\n                };\n                let params = if let Some(parameter_list) = &mut procedure.parameter_list {\n                    self.analyze_interface_list(&subpgm_region, ent, parameter_list, diagnostics)\n                } else {\n                    Ok(FormalRegion::new_params())\n                };\n                match ParameterRegion::from_formal_region(params?) {\n                    Ok(params) => (Signature::new(params, None), generic_map),\n                    Err(invalid_formals) => {\n                        self.push_invalid_formals_into_diagnostics(&invalid_formals, diagnostics);\n                        return Err(EvalError::Unknown);\n                    }\n                }\n            }\n        };\n\n        let mut kind = to_kind(signature);\n        if let Some(map) = generic_map {\n            match kind {\n                Overloaded::SubprogramDecl(signature) => {\n                    kind = Overloaded::UninstSubprogramDecl(signature, map)\n                }\n                Overloaded::Subprogram(signature) => {\n                    kind = Overloaded::UninstSubprogram(signature, map)\n                }\n                _ => unreachable!(),\n            }\n        }\n\n        match kind {\n            Overloaded::Subprogram(_) => {\n                let declared_by =\n                    self.find_subpgm_specification(scope, subprogram, kind.signature());\n\n                if let Some(declared_by) = declared_by {\n                    unsafe {\n                        ent.set_declared_by(declared_by.into());\n                    }\n                }\n            }\n            Overloaded::UninstSubprogram(_, _) => {\n                let declared_by =\n                    self.find_uninst_subpgm_specification(scope, subprogram, kind.signature());\n\n                if let Some(declared_by) = declared_by {\n                    unsafe {\n                        ent.set_declared_by(declared_by.into());\n                    }\n                }\n            }\n            _ => {}\n        }\n\n        unsafe {\n            ent.set_kind(AnyEntKind::Overloaded(kind));\n        }\n        subprogram.set_decl_id(ent.id());\n        Ok((subpgm_region, ent))\n    }"
}