{
    "level": "Info",
    "analyzer": "UnsafeDataflow",
    "op_type": "Transmute",
    "description": "Potential unsafe dataflow issue in `ConcurrentMap::<K, V, FANOUT, LOCAL_GC_BUFFER_SIZE>::cas`",
    "file": "concurrent-map-5.0.37/src/lib.rs",
    "start_line": 1285,
    "start_col": 5,
    "end_line": 1325,
    "end_col": 6,
    "code_snippet": "pub fn cas<VRef>(\n        &self,\n        key: K,\n        old: Option<&VRef>,\n        new: Option<V>,\n    ) -> Result<Option<V>, CasFailure<V>>\n    where\n        V: Borrow<VRef>,\n        VRef: PartialEq + ?Sized,\n    {\n        loop {\n            let mut guard = self.ebr.pin();\n            let leaf = self.inner.leaf_for_key(LeafSearch::Eq(&key), &mut guard);\n            let mut leaf_clone: Box<Node<K, V, FANOUT>> = Box::new((*leaf).clone());\n            let ret = leaf_clone.cas(key.clone(), old, new.clone());\n\n            let rhs_ptr_opt = if leaf_clone.should_split() {\n                Some(leaf_clone.split())\n            } else {\n                None\n            };\n\n            let install_attempt = leaf.cas(leaf_clone, &mut guard);\n\n            if install_attempt.is_ok() {\n                if matches!(ret, Ok(Some(_))) && new.is_none() {\n                    self.len.fetch_sub(1, Ordering::Relaxed);\n                } else if matches!(ret, Ok(None)) && new.is_some() {\n                    self.len.fetch_add(1, Ordering::Relaxed);\n                }\n                return ret;\n            } else if let Some(new_ptr) = rhs_ptr_opt {\n                // clear dangling BoxedAtomicPtr (cas freed pointee already)\n                let reclaimed_ptr: Box<AtomicPtr<Node<K, V, FANOUT>>> =\n                    unsafe { Box::from_raw(new_ptr.0 as *mut _) };\n\n                let _dropping_reclaimed_rhs: Box<Node<K, V, FANOUT>> =\n                    unsafe { Box::from_raw(reclaimed_ptr.load(Ordering::Acquire)) };\n            }\n        }\n    }"
}